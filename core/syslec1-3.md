# Node.jsについて知ろう

## はじめに
僕がNode.jsの勉強を始めてちょうど1年ぐらいになります。一応、リファレンスやそのほかの記事を読み漁りながらの勉強なので、使い方が間違っている、こういう考え方は違うということがあると思います。このテキストは自分が知っていることをできる限り触れるようにしていき、より深いことを学ぶ一助となればいいなと思います。

## Node.jsとは

みなさん、JavaScriptをどのように勉強してきましたか？
ブラウザで開いて見ていたと思います。
おそらくそこでふと思います。「JavaScript書くのにいちいちhtmlのファイルも作るなんてめんどくさい」「JavaScript単体でテストしたい」と。

そんなあなたにNode.jsというわけです。（これは創作です。実際の開発目的は別です。）

つまり、Node.jsはブラウザのJavaScriptを実行する部分だけを持ってきたものです。ちなみに、Node.jsはブラウザのV8という名前のJavaScript実行エンジンをもとに作られています。

というわけでJavaScriptを実行してみましょう。まず、適当なフォルダを作り、そこでtest.jsというjsファイルを作りましょう。そして、以下のコードを書き込んでください。

```javascript
console.log("Hello World!")
```

さて、お待ちかねの実行です。まず、ターミナルでtest.jsというファイルがある階層まで移ってください。これ以降この階層でコマンドを打つこととします。そして、以下のコマンドを打ってください。

```
node test.js
```

ちゃんと表示されたでしょうか？

ちなみに、jsファイルを表す`.js`の部分は省略可能です。

また、ブラウザでいう画面がないので、`alert()`とか`prompt()`という関数は（たぶん）使えないはずです。

## node package managerを使ってみよう

さて、みなさんJavaScriptをかけますね。というわけなので、サーバーを立ててください。と言われても、おそらく無理でしょう。

そういう時に便利な関数のセットをダウンロードすることができます。その仕組みがnode package managerです。

補足ですが、`yarn`というマネージャーもあります。今回は正しい入れ方がよくわからないので、npmでいこうと思います。

というわけで使いましょう。使う際はフォルダごとにパッケージをインストールできます。（ここ重要）というわけで、さっきjsファイルを作ったフォルダでパッケージを使いましょう。

```
npm init
```

とりあえず、何か出てきますが、それはパッケージの設定です。基本的にはリリースをしなければ関係ないです。

`package.json`というファイルができたと思います。ここにはどういうパッケージをインストールしたか、コマンドのショートカットみたいなものが書かれていきます。こうすることで、インストールしたパッケージ全部を共有しなくても、この`package.json`を共有すればよくなります。

これで使えるようになりました。試しに、なんかのパッケージをインストールしましょう。

今回は`nanoid`をインストールして、どのようにパッケージをインストールできるかをみてみましょう。`nanoid`はランダムな文字列を生成する関数が入ったパッケージです。

パッケージは以下のようにインストールできます。
```
npm install パッケージ名 --save
```

ちなみに、`--save`という部分はどういうパッケージをインストールしたかを記述させるオプションです。つけましょう。

`nanoid`をインストールしましょう。
```
npm install nanoid --save
```
とします。これでインストールできました。


インストールしたら、`package.json`を見てください。dependencyという欄に、`nanoid`が増えていますでしょうか。こういう感じで、インストールしたパッケージが書かれていきます。

では、jsファイルでnanoidを使いましょう。以下のように書きます。

```javascript
const 変数 = require("パッケージ名")
```

変数の中に関数が入っていく感じです。`nanoid`の場合は
```javascript
const nanoid = require("nanoid")
```
というわけで、これでnanoidをjsファイルの中で使えるようになりました。では、以下のコードをコピペして動かしましょう。

```javascript
const nanoid = require("nanoid")

let str = nanoid()
console.log(str)
```

さて、いま`node test.js`みたいにして、動かしたと思います。実はnpmにはコマンドを保存する機能がついています。
```
"script": {
    "名前": "呼び出すコマンド",
}
```

では、試しに`package.json`の`script`を以下のように書き換えてみてください。
```
"script": {
    "test": "node test.js",
}
```

これで、コマンドが使えるようになりました。コマンドの呼び出し方は以下のようになります。

```
npm run 名前
```

というわけで、ここでは
```
npm run test
```
となります。

これで、npmは使えるようになりましたね。


## require文について

さて、大きなプロジェクトを開発していくと一つのファイルにまとめると開発しづらいですね。そういう時のために、実はNode.jsはファイルを分割出来ます。

次のは分割したファイルです。

compare.js
```javascript
function max(x, y) {
    if (x > y) return x
    else y
}
function min(x, y) {
    if (x > y) return y
    else x
}

module.export = {
    max: max,
    min: min
}
```

test.js
```javascript
const comp = require("compare.js")

console.log(comp.max(10, 5))
console.log(comp.min(10, 5))
```

`compare.js`の最後の部分は以下のようにもかけます。
```javascript
module.export.max = max
module.export.min = min
```

まあ、いいやよくわからん。
